<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Progreso - FlowFit</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <!-- FlowFit CSS -->
    <link th:href="@{/css/flowfit-base.css}" rel="stylesheet">
    <link th:href="@{/css/flowfit-usuario.css}" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <!-- Mobile Toggle -->
  <button class="sidebar-toggle-base sidebar-toggle-usuario d-md-none" id="sidebarToggle">
    <i class="bi bi-list fs-4"></i>
  </button>

  <!-- Sidebar Overlay for Mobile -->
  <div class="sidebar-overlay-base" id="sidebarOverlay"></div>

  <!-- FlowFit Sidebar -->
  <div th:replace="~{fragments/sidebar-usuario :: sidebar}"></div>

  <!-- Main Content -->
  <main class="main-content-base fade-in-up">
    <div class="container-fluid px-4 py-4">
      <!-- Page Header -->
      <div class="page-header mb-4">
        <div class="d-flex justify-content-between align-items-center flex-wrap">
          <div>
            <h1 class="page-title text-white mb-2">
              <i class="bi bi-graph-up me-2"></i>
              Mi Progreso
            </h1>
            <p class="page-subtitle text-muted-flowfit mb-0">
              Visualiza tu evoluci칩n y logros 游늵
            </p>
          </div>
          <div class="mt-3 mt-md-0">
            <a th:href="@{/usuario/progreso/descargar-pdf}" 
               class="btn btn-usuario-outline" 
               style="border-radius: 12px; padding: 0.625rem 1.25rem; font-weight: 500;">
              <i class="bi bi-file-earmark-pdf me-2"></i>
              Descargar PDF
            </a>
          </div>
        </div>
      </div>

      <!-- Estad칤sticas Generales -->
      <div class="row g-4 mb-5">
        <!-- Progreso General -->
        <div class="col-lg-3 col-md-6">
          <div class="card-base card-usuario h-100" style="border-radius: 16px; padding: 1.75rem;">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h4 class="mb-2 text-white" style="font-weight: 600;" th:text="${progresoGeneral != null ? progresoGeneral + '%' : '0%'}">65%</h4>
                <div class="mb-3" style="color: #e2e8f0; font-size: 0.9375rem; font-weight: 500;">Progreso General</div>
                <div class="progress" style="height: 8px; background: rgba(255,255,255,0.05); border-radius: 10px; overflow: hidden;">
                  <div class="progress-bar" style="background: linear-gradient(90deg, #4ade80 0%, #22c55e 100%); border-radius: 10px; box-shadow: 0 0 10px rgba(74, 222, 128, 0.4);" th:style="'width: ' + ${progresoGeneral != null ? progresoGeneral : 0} + '%'"></div>
                </div>
              </div>
              <div class="stat-icon-container" style="width: 56px; height: 56px; border-radius: 50%; background: rgba(251, 191, 36, 0.15); display: flex; align-items-center; justify-content: center;">
                <i class="bi bi-trophy-fill" style="font-size: 1.75rem; color: #fbbf24;"></i>
              </div>
            </div>
          </div>
        </div>

        <!-- Rutinas Completadas -->
        <div class="col-lg-3 col-md-6">
          <div class="card-base card-usuario h-100" style="border-radius: 16px; padding: 1.75rem;">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h4 class="mb-2 text-white" style="font-weight: 600;" th:text="${rutinasCompletadas}">12</h4>
                <div class="mb-2" style="color: #e2e8f0; font-size: 0.9375rem; font-weight: 500;">Rutinas Completadas</div>
                <small style="color: #cbd5e1; font-size: 0.875rem;">de <span th:text="${rutinasTotal}">15</span> asignadas</small>
              </div>
              <div style="width: 56px; height: 56px; border-radius: 50%; background: rgba(34, 197, 94, 0.15); display: flex; align-items: center; justify-content: center;">
                <i class="bi bi-check-circle-fill" style="font-size: 1.75rem; color: #4ade80;"></i>
              </div>
            </div>
          </div>
        </div>

        <!-- D칤as Activos -->
        <div class="col-lg-3 col-md-6">
          <div class="card-base card-usuario h-100" style="border-radius: 16px; padding: 1.75rem;">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h4 class="mb-2 text-white" style="font-weight: 600;" th:text="${diasActivosEsteMes}">18</h4>
                <div class="mb-2" style="color: #e2e8f0; font-size: 0.9375rem; font-weight: 500;">D칤as Activos</div>
                <small style="color: #cbd5e1; font-size: 0.875rem;">este mes</small>
              </div>
              <div style="width: 56px; height: 56px; border-radius: 50%; background: rgba(59, 130, 246, 0.15); display: flex; align-items: center; justify-content: center;">
                <i class="bi bi-calendar-event" style="font-size: 1.75rem; color: #60a5fa;"></i>
              </div>
            </div>
          </div>
        </div>

        <!-- Racha Actual -->
        <div class="col-lg-3 col-md-6">
          <div class="card-base card-usuario h-100" style="border-radius: 16px; padding: 1.75rem;">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h4 class="mb-2 text-white" style="font-weight: 600;" th:text="${rachaActual}">7</h4>
                <div class="mb-2" style="color: #e2e8f0; font-size: 0.9375rem; font-weight: 500;">Racha Actual</div>
                <small style="color: #cbd5e1; font-size: 0.875rem;">d칤as consecutivos</small>
              </div>
              <div style="width: 56px; height: 56px; border-radius: 50%; background: rgba(239, 68, 68, 0.15); display: flex; align-items: center; justify-content: center;">
                <i class="bi bi-fire" style="font-size: 1.75rem; color: #f87171;"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Gr치ficos de Progreso -->
      <div class="row g-4 mb-5">
        <!-- Progreso Semanal -->
        <div class="col-lg-8">
          <div class="card-base card-usuario" style="border-radius: 16px; padding: 2rem;">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <div>
                <h5 class="text-white mb-2" style="font-size: 1.125rem; font-weight: 600;">
                  <i class="bi bi-graph-up me-2" style="color: #60a5fa;"></i>Progreso Semanal
                </h5>
                <p class="mb-0" style="color: #cbd5e1; font-size: 0.875rem;">Rutinas completadas en los 칰ltimos 7 d칤as</p>
              </div>
            </div>
            <div class="chart-container" style="position: relative; height: 300px;">
              <canvas id="progresoChart"></canvas>
              <div id="noDataMessage" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #94a3b8;">
                <i class="bi bi-graph-up" style="font-size: 3rem; opacity: 0.3;"></i>
                <p class="mt-3 mb-0" style="font-size: 0.9rem;">Completa rutinas para ver tu progreso aqu칤</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Distribuci칩n de Rutinas -->
        <div class="col-lg-4">
          <div class="card-base card-usuario" style="border-radius: 16px; padding: 2rem;">
            <div class="mb-4">
              <h5 class="text-white mb-2" style="font-size: 1.125rem; font-weight: 600;">
                <i class="bi bi-pie-chart me-2" style="color: #a78bfa;"></i>Estado de Rutinas
              </h5>
              <p class="mb-0" style="color: #cbd5e1; font-size: 0.875rem;">Distribuci칩n actual</p>
            </div>
            <div class="chart-container mb-4" style="position: relative; height: 200px;">
              <canvas id="distribucionChart"></canvas>
            </div>
            <div class="chart-legend">
              <div class="d-flex justify-content-between align-items-center mb-3 p-2" style="background: rgba(34, 197, 94, 0.1); border-radius: 8px;">
                <div class="d-flex align-items-center">
                  <div style="width: 12px; height: 12px; border-radius: 50%; background: #4ade80; margin-right: 0.75rem;"></div>
                  <span style="color: #cbd5e1; font-size: 0.875rem;">Completadas</span>
                </div>
                <span class="fw-bold" style="color: #4ade80;" th:text="${rutinasCompletadas}">12</span>
              </div>
              <div class="d-flex justify-content-between align-items-center mb-3 p-2" style="background: rgba(59, 130, 246, 0.1); border-radius: 8px;">
                <div class="d-flex align-items-center">
                  <div style="width: 12px; height: 12px; border-radius: 50%; background: #60a5fa; margin-right: 0.75rem;"></div>
                  <span style="color: #cbd5e1; font-size: 0.875rem;">En Progreso</span>
                </div>
                <span class="fw-bold" style="color: #60a5fa;" th:text="${rutinasEnProgreso}">3</span>
              </div>
              <div class="d-flex justify-content-between align-items-center p-2" style="background: rgba(148, 163, 184, 0.1); border-radius: 8px;">
                <div class="d-flex align-items-center">
                  <div style="width: 12px; height: 12px; border-radius: 50%; background: #94a3b8; margin-right: 0.75rem;"></div>
                  <span style="color: #cbd5e1; font-size: 0.875rem;">Pausadas</span>
                </div>
                <span class="fw-bold" style="color: #94a3b8;">0</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Rutinas Recientes y Motivaci칩n -->
      <div class="row mb-5">
        <!-- Rutinas Recientes -->
        <div class="col-lg-8 mb-4">
          <div class="card-base card-usuario" style="border-radius: 16px; padding: 2rem;">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <div>
                <h5 class="text-white mb-2" style="font-size: 1.125rem; font-weight: 600;">
                  <i class="bi bi-clock-history me-2" style="color: #fb923c;"></i>Actividad Reciente
                </h5>
                <p class="mb-0" style="color: #cbd5e1; font-size: 0.875rem;">Tus 칰ltimas rutinas trabajadas</p>
              </div>
              <a th:href="@{/usuario/rutinas}" class="btn-usuario" style="padding: 0.5rem 1rem; font-size: 0.875rem;">
                <i class="bi bi-eye me-1"></i>Ver Todas
              </a>
            </div>
            <div class="rutinas-recientes">
              <div th:each="rutina : ${rutinasAsignadas}" th:if="${rutinaStat.index < 5}" 
                   class="mb-3">
                <div style="background: rgba(255, 255, 255, 0.03); padding: 1.25rem; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.08);">
                  <div class="d-flex align-items-center">
                    <div style="width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; flex-shrink: 0;"
                         th:style="${rutina.estado.toString() == 'COMPLETADA'} ? 'background: rgba(34, 197, 94, 0.15);' : 'background: rgba(59, 130, 246, 0.15);'">
                      <i th:class="${rutina.estado.toString() == 'COMPLETADA'} ? 'bi bi-check-circle-fill' : 'bi bi-play-circle-fill'"
                         th:style="${rutina.estado.toString() == 'COMPLETADA'} ? 'color: #4ade80; font-size: 1.25rem;' : 'color: #60a5fa; font-size: 1.25rem;'"></i>
                    </div>
                    <div class="flex-grow-1">
                      <h6 class="mb-2 text-white" style="font-weight: 600;" th:text="'Rutina ID: ' + ${rutina.rutinaId}">Rutina de Fuerza</h6>
                      <div class="d-flex align-items-center mb-2">
                        <small style="color: #cbd5e1; margin-right: 1rem;">
                          <i class="bi bi-calendar-check me-1"></i>
                          <span th:text="'Asignada: ' + ${#temporals.format(rutina.fechaAsignacion, 'dd/MM/yyyy')}">Asignada: 15/03/2024</span>
                        </small>
                      </div>
                      <div class="d-flex align-items-center">
                        <div class="progress flex-grow-1 me-3" style="height: 8px; background: rgba(255, 255, 255, 0.05); border-radius: 50px; overflow: hidden;">
                          <div class="progress-bar" th:style="'width: ' + ${rutina.progreso} + '%; background: linear-gradient(90deg, #4ade80, #22c55e);'"></div>
                        </div>
                        <small class="fw-bold" style="color: #4ade80; min-width: 40px; text-align: right;" th:text="${rutina.progreso} + '%'">85%</small>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Panel de Motivaci칩n -->
        <div class="col-lg-4 mb-4">
          <div class="card-base card-usuario" style="border-radius: 16px; padding: 2rem;">
            <div class="text-center">
              <div style="width: 72px; height: 72px; border-radius: 50%; background: rgba(251, 191, 36, 0.15); display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                <i class="bi bi-award-fill" style="font-size: 2rem; color: #fbbf24;"></i>
              </div>
              <h5 class="text-white fw-bold mb-2" style="font-size: 1.125rem;">춰Excelente Progreso!</h5>
              <p class="mb-4" style="color: #cbd5e1; font-size: 0.9375rem;">
                Has completado <span class="fw-bold" style="color: #4ade80;" th:text="${rutinasCompletadas}">12</span> rutinas este mes.
              </p>
              
              <!-- Pr칩ximos Objetivos -->
              <div class="text-start">
                <h6 class="text-white mb-3" style="font-weight: 600; font-size: 0.9375rem;">
                  <i class="bi bi-target me-2" style="color: #a78bfa;"></i>Pr칩ximos Objetivos
                </h6>
                
                <div class="mb-3">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <span style="color: #cbd5e1; font-size: 0.875rem;">Completar 15 rutinas</span>
                    <span class="badge" style="background: rgba(59, 130, 246, 0.15); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3); padding: 0.25rem 0.5rem; border-radius: 50px; font-size: 0.75rem;" th:text="${rutinasCompletadas} + '/15'">12/15</span>
                  </div>
                  <div class="progress" style="height: 8px; background: rgba(255, 255, 255, 0.05); border-radius: 50px; overflow: hidden;">
                    <div class="progress-bar" th:style="'width: ' + ${(rutinasCompletadas * 100) / 15} + '%; background: linear-gradient(90deg, #60a5fa, #3b82f6);'"></div>
                  </div>
                </div>
                
                <div class="mb-3">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <span style="color: #cbd5e1; font-size: 0.875rem;">Racha de 10 d칤as</span>
                    <span class="badge" style="background: rgba(251, 191, 36, 0.15); color: #fbbf24; border: 1px solid rgba(251, 191, 36, 0.3); padding: 0.25rem 0.5rem; border-radius: 50px; font-size: 0.75rem;" th:text="${rachaActual} + '/10'">7/10</span>
                  </div>
                  <div class="progress" style="height: 8px; background: rgba(255, 255, 255, 0.05); border-radius: 50px; overflow: hidden;">
                    <div class="progress-bar" th:style="'width: ' + ${(rachaActual * 100) / 10} + '%; background: linear-gradient(90deg, #fbbf24, #f59e0b);'"></div>
                  </div>
                </div>
                
                <div class="mb-4">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <span style="color: #cbd5e1; font-size: 0.875rem;">20 d칤as activos</span>
                    <span class="badge" style="background: rgba(34, 197, 94, 0.15); color: #4ade80; border: 1px solid rgba(34, 197, 94, 0.3); padding: 0.25rem 0.5rem; border-radius: 50px; font-size: 0.75rem;" th:text="${diasActivosEsteMes} + '/20'">18/20</span>
                  </div>
                  <div class="progress" style="height: 8px; background: rgba(255, 255, 255, 0.05); border-radius: 50px; overflow: hidden;">
                    <div class="progress-bar" th:style="'width: ' + ${(diasActivosEsteMes * 100) / 20} + '%; background: linear-gradient(90deg, #4ade80, #22c55e);'"></div>
                  </div>
                </div>
              </div>

              <!-- Mensaje Motivacional -->
              <div class="p-3" style="background: rgba(255, 255, 255, 0.03); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.08);">
                <div style="width: 48px; height: 48px; border-radius: 50%; background: rgba(96, 165, 250, 0.15); display: flex; align-items: center; justify-content: center; margin: 0 auto 0.75rem;">
                  <i class="bi bi-emoji-smile" style="font-size: 1.5rem; color: #60a5fa;"></i>
                </div>
                <p class="mb-0 text-white" style="font-size: 0.875rem; line-height: 1.6;">
                  <span th:if="${progresoGeneral >= 80}">춰Est치s en una racha incre칤ble! Sigue as칤 y alcanzar치s tus metas.</span>
                  <span th:if="${progresoGeneral >= 60 && progresoGeneral < 80}">춰Muy buen trabajo! Est치s por encima del promedio.</span>
                  <span th:if="${progresoGeneral >= 40 && progresoGeneral < 60}">Buen progreso. Mant칠n la consistencia para mejores resultados.</span>
                  <span th:if="${progresoGeneral < 40}">춰Cada paso cuenta! Mant칠n el ritmo y ver치s mejoras pronto.</span>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div> <!-- Cierre container-fluid -->
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script th:inline="javascript">
    // Sidebar Toggle
    document.getElementById('sidebarToggle')?.addEventListener('click', function() {
      document.getElementById('sidebar')?.classList.toggle('collapsed');
      document.getElementById('main-content')?.classList.toggle('expanded');
    });

    // Datos desde el backend para gr치fico de progreso semanal
    const fechasBackend = /*[[${fechasArray}]]*/ [];
    const rutinasBackend = /*[[${ejerciciosArray}]]*/ []; // Ahora contiene rutinas completadas, no ejercicios
    
    // Datos para gr치fico de distribuci칩n de rutinas
    const rutinasCompletadasData = /*[[${rutinasCompletadas}]]*/ 0;
    const rutinasEnProgresoData = /*[[${rutinasEnProgreso}]]*/ 0;
    const rutinasTotalData = rutinasCompletadasData + rutinasEnProgresoData;

    console.log('=== DATOS RECIBIDOS EN JS ===');
    console.log('Fechas:', fechasBackend);
    console.log('Rutinas completadas por d칤a:', rutinasBackend);
    console.log('Total rutinas completadas:', rutinasCompletadasData);
    console.log('Rutinas en progreso:', rutinasEnProgresoData);
    console.log('Longitud fechas:', fechasBackend.length);
    
    // Formatear datos para el gr치fico de progreso semanal
    let labels = [];
    let data = [];
    
    if (fechasBackend && fechasBackend.length > 0) {
      // Hay datos, formatear fechas
      labels = fechasBackend.map(fechaStr => {
        // Formato DD/MM ya viene del backend
        return fechaStr;
      });
      data = rutinasBackend; // Rutinas completadas por d칤a
    } else {
      // No hay datos, mostrar 칰ltimos 7 d칤as vac칤os
      const hoy = new Date();
      for (let i = 6; i >= 0; i--) {
        const fecha = new Date(hoy);
        fecha.setDate(hoy.getDate() - i);
        labels.push(fecha.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit' }));
        data.push(0);
      }
    }

    console.log('Labels para gr치fico:', labels);
    console.log('Data para gr치fico:', data);
    console.log('=============================\n');

    // Gr치fico de Progreso Semanal
    const ctx = document.getElementById('progresoChart');
    if (!ctx) {
      console.error('No se encontr칩 el canvas progresoChart');
    } else {
      // Verificar si todos los datos son 0
      const tienesDatos = data.some(val => val > 0);
      
      if (!tienesDatos) {
        const noDataMsg = document.getElementById('noDataMessage');
        if (noDataMsg) {
          noDataMsg.style.display = 'block';
          ctx.style.opacity = '0.3';
        }
      }

      const progresoChart = new Chart(ctx.getContext('2d'), {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Rutinas completadas',
            data: data,
            borderColor: '#4ade80',
            backgroundColor: 'rgba(74, 222, 128, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4,
            pointBackgroundColor: '#4ade80',
            pointBorderColor: '#fff',
            pointBorderWidth: 2,
            pointRadius: 6,
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleColor: '#fff',
              bodyColor: '#cbd5e1',
              borderColor: 'rgba(255, 255, 255, 0.1)',
              borderWidth: 1,
              callbacks: {
                label: function(context) {
                  return 'Rutinas: ' + context.parsed.y;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              grid: {
                color: 'rgba(255, 255, 255, 0.08)'
              },
              ticks: {
                color: 'rgba(255, 255, 255, 0.6)',
                stepSize: 1,
                callback: function(value) {
                  return Math.floor(value);
                }
              }
            },
            x: {
              grid: {
                color: 'rgba(255, 255, 255, 0.08)'
              },
              ticks: {
                color: 'rgba(255, 255, 255, 0.6)'
              }
            }
          },
          interaction: {
            intersect: false,
            mode: 'index'
          }
        }
      });
    }

    // Gr치fico de Distribuci칩n de Rutinas
    const ctx2 = document.getElementById('distribucionChart');
    if (!ctx2) {
      console.error('No se encontr칩 el canvas distribucionChart');
    } else {
      const distribucionChart = new Chart(ctx2.getContext('2d'), {
        type: 'doughnut',
        data: {
          labels: ['Completadas', 'En Progreso', 'Pausadas'],
          datasets: [{
            data: [rutinasCompletadasData, rutinasEnProgresoData, 0],
            backgroundColor: ['#4ade80', '#60a5fa', '#94a3b8'],
            borderWidth: 0,
            cutout: '70%',
            borderRadius: 4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleColor: '#fff',
              bodyColor: '#cbd5e1',
              borderColor: 'rgba(255, 255, 255, 0.1)',
              borderWidth: 1,
              callbacks: {
                label: function(context) {
                  const label = context.label || '';
                  const value = context.parsed || 0;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = total > 0 ? Math.round((value / total) * 100) : 0;
                  return label + ': ' + value + ' (' + percentage + '%)';
                }
              }
            }
          }
        }
      });
      
      console.log('Gr치fico de distribuci칩n creado con datos:', {
        completadas: rutinasCompletadasData,
        enProgreso: rutinasEnProgresoData,
        total: rutinasTotalData
      });
    }

    // Nota: El gr치fico muestra rutinas completadas (no ejercicios individuales)

    // Animaciones de entrada
    window.addEventListener('load', function() {
      // Animar las tarjetas de estad칤sticas
      const statCards = document.querySelectorAll('.stat-card');
      statCards.forEach((card, index) => {
        setTimeout(() => {
          card.style.opacity = '0';
          card.style.transform = 'translateY(20px)';
          card.style.transition = 'all 0.5s ease';
          
          setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
          }, 100);
        }, index * 100);
      });

      // Animar n칰meros con efecto contador
      const statNumbers = document.querySelectorAll('.stat-number');
      statNumbers.forEach(number => {
        const finalValue = parseInt(number.textContent.replace(/[^\d]/g, ''));
        if (!isNaN(finalValue)) {
          animateNumber(number, 0, finalValue, 1500);
        }
      });
    });

    // Funci칩n para animar n칰meros
    function animateNumber(element, start, end, duration) {
      let startTime = null;
      const originalText = element.textContent;
      const suffix = originalText.replace(/[\d]/g, '');
      
      function animate(currentTime) {
        if (startTime === null) startTime = currentTime;
        const progress = Math.min((currentTime - startTime) / duration, 1);
        const current = Math.round(progress * (end - start) + start);
        element.textContent = current + suffix;
        
        if (progress < 1) {
          requestAnimationFrame(animate);
        }
      }
      
      requestAnimationFrame(animate);
    }
  </script>

  <!-- Sidebar Responsive JS -->
  <!-- FlowFit VIP Usuario Script -->
  <script>
    // Mobile Sidebar Toggle
    document.addEventListener('DOMContentLoaded', function() {
      const sidebarToggle = document.getElementById('sidebarToggle');
      const sidebar = document.getElementById('sidebar');
      const sidebarOverlay = document.getElementById('sidebarOverlay');

      function toggleSidebar() {
        sidebar.classList.toggle('show');
        sidebarOverlay.classList.toggle('show');
      }

      function closeSidebar() {
        sidebar.classList.remove('show');
        sidebarOverlay.classList.remove('show');
      }

      sidebarToggle?.addEventListener('click', toggleSidebar);
      sidebarOverlay?.addEventListener('click', closeSidebar);

      // Close sidebar on escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeSidebar();
      });

      // Highlight active navigation
      const currentPath = window.location.pathname;
      const navLinks = document.querySelectorAll('.nav-link-usuario');
      
      navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === currentPath) {
          link.classList.add('active');
        }
      });

      console.log('FlowFit VIP Usuario Progreso loaded successfully! 游눩');
    });
  </script>

</body>
</html>
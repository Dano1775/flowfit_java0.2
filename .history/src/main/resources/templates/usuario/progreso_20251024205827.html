<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Progreso - FlowFit</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <!-- FlowFit VIP CSS -->
    <link th:href="@{/css/flowfit-base.css}" rel="stylesheet">
    <link th:href="@{/css/flowfit-usuario.css}" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="flowfit-body usuario-body">

  <!-- Sidebar -->
  <nav class="sidebar-base sidebar-usuario" id="sidebar">
    <!-- Brand Section -->
    <div class="sidebar-brand-base">
      <div class="brand-container">
        <i class="bi bi-activity brand-icon-base"></i>
        <span class="brand-text-base">FlowFit VIP</span>
      </div>
    </div>

    <!-- Navigation Links -->
    <div class="sidebar-nav-base">
      <a th:href="@{/usuario/dashboard}" class="nav-link-usuario">
        <i class="bi bi-speedometer2 me-3"></i>
        <span>Dashboard</span>
      </a>
      <a th:href="@{/usuario/rutinas}" class="nav-link-usuario">
        <i class="bi bi-calendar-check me-3"></i>
        <span>Mis Rutinas</span>
      </a>
      <a th:href="@{/usuario/buscar-entrenador}" class="nav-link-usuario">
        <i class="bi bi-person-plus me-3"></i>
        <span>Mi Entrenador</span>
      </a>
      <a th:href="@{/usuario/progreso}" class="nav-link-usuario active">
        <i class="bi bi-graph-up me-3"></i>
        <span>Mi Progreso</span>
      </a>
      <a th:href="@{/usuario/perfil}" class="nav-link-usuario">
        <i class="bi bi-person-gear me-3"></i>
        <span>Mi Perfil</span>
      </a>
    </div>

    <!-- Profile Section -->
    <div class="border-top pt-3 mt-auto">
      <div class="dropdown profile-dropdown-base">
        <div class="profile-icon-base d-flex align-items-center w-100" id="profileDropdownUsuario" data-bs-toggle="dropdown" aria-expanded="false">
          <img src="/assets/perfil_default.png" alt="Profile" class="profile-image-base me-2" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
          <div class="flex-grow-1">
            <div class="small fw-bold text-white" th:text="${usuario != null ? #strings.substringBefore(usuario.nombre, ' ') : 'Usuario'}">Usuario</div>
            <div class="small text-muted-flowfit">FlowFit VIP</div>
          </div>
          <i class="bi bi-chevron-down text-white"></i>
        </div>
        <ul class="dropdown-menu" aria-labelledby="profileDropdownUsuario">
          <li><a class="dropdown-item" th:href="@{/usuario/perfil}"><i class="bi bi-person-gear me-2"></i>Mi Perfil</a></li>
          <li><a class="dropdown-item" th:href="@{/usuario/configuracion}"><i class="bi bi-gear me-2"></i>Configuraci√≥n</a></li>
          <li><a class="dropdown-item" th:href="@{/usuario/soporte}"><i class="bi bi-headset me-2"></i>Soporte</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item text-danger" th:href="@{/logout}"><i class="bi bi-box-arrow-right me-2"></i>Cerrar Sesi√≥n</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Sidebar Overlay for Mobile -->
  <div class="flowfit-sidebar-overlay d-lg-none" id="sidebarOverlay"></div>

  <!-- Sidebar Toggle Button for Mobile -->
  <button class="flowfit-sidebar-toggle sidebar-toggle-usuario d-lg-none" id="sidebarToggle">
    <i class="bi bi-list"></i>
  </button>
      <li class="nav-item">
        <a th:href="@{/usuario/rutinas}" class="nav-link nav-link-usuario">
          <i class="bi bi-calendar-check me-3"></i>
          <span>Mis Rutinas</span>
        </a>
      </li>
      <li class="nav-item">
        <a th:href="@{/usuario/progreso}" class="nav-link nav-link-usuario active" aria-current="page">
          <i class="bi bi-graph-up me-3"></i>
          <span>Mi Progreso</span>
        </a>
      </li>
    </ul>

    <!-- Perfil de Usuario -->
    <div class="border-top pt-3 mt-auto">
      <div class="dropdown flowfit-profile-dropdown">
        <div class="flowfit-profile-icon d-flex align-items-center w-100" id="profileDropdownUsuario" data-bs-toggle="dropdown" aria-expanded="false">
          <img src="/assets/perfil_default.png" alt="Profile" class="flowfit-profile-image me-3">
          <div class="flex-grow-1">
            <div class="small fw-bold text-white" th:text="${#strings.substringBefore(usuario.nombre, ' ')}">Usuario</div>
            <div class="small text-muted">FlowFit VIP</div>
          </div>
          <i class="bi bi-chevron-down text-white-50"></i>
        </div>
        <ul class="dropdown-menu dropdown-menu-dark flowfit-dropdown-menu" aria-labelledby="profileDropdownUsuario">
          <li><a class="dropdown-item" th:href="@{/usuario/perfil}"><i class="bi bi-person-gear me-2"></i>Mi Perfil</a></li>
          <li><a class="dropdown-item" th:href="@{/usuario/configuracion}"><i class="bi bi-gear me-2"></i>Configuraci√≥n</a></li>
          <li><a class="dropdown-item" th:href="@{/usuario/soporte}"><i class="bi bi-headset me-2"></i>Soporte</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item flowfit-dropdown-danger" th:href="@{/logout}"><i class="bi bi-box-arrow-right me-2"></i>Cerrar Sesi√≥n</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Sidebar Toggle -->
  <button class="btn sidebar-toggle-base d-lg-none" type="button" id="sidebarToggle">
    <i class="bi bi-list"></i>
  </button>

  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay-base d-lg-none" id="sidebarOverlay"></div>

  <!-- Main Content -->
  <main class="main-content-base fade-in-up">
    <div class="container-fluid">
      <!-- Header Section -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="flowfit-page-header">
            <div class="flowfit-page-title">
              <h1 class="flowfit-title">
                <i class="bi bi-graph-up me-2 icon-usuario"></i>
                Mi Progreso
              </h1>
              <p class="flowfit-subtitle">Visualiza tu evoluci√≥n y logros</p>
              <div class="flowfit-breadcrumb">
                <span>¬°Hola, <span th:text="${#strings.substringBefore(usuario.nombre, ' ')}">Usuario</span>!</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Estad√≠sticas Generales -->
      <div class="row mb-4">
        <!-- Progreso General -->
        <div class="col-lg-3 col-md-6 mb-4">
          <div class="flowfit-card stat-card-usuario">
            <div class="d-flex align-items-center">
              <div class="flowfit-icon icon-usuario">
                <i class="bi bi-trophy-fill fs-2"></i>
              </div>
              <div class="ms-3 flex-grow-1">
                <h3 class="fw-bold text-white mb-1" th:text="${progresoGeneral != null ? progresoGeneral + '%' : '0%'}">65%</h3>
                <p class="text-muted mb-0 small fw-medium">Progreso General</p>
                <div class="progress-usuario mt-2">
                  <div class="progress-bar" th:style="'width: ' + ${progresoGeneral != null ? progresoGeneral : 0} + '%'"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Rutinas Completadas -->
        <div class="col-lg-3 col-md-6 mb-4">
          <div class="flowfit-card stat-card-usuario">
            <div class="d-flex align-items-center">
              <div class="flowfit-icon icon-usuario">
                <i class="bi bi-check-circle-fill fs-2"></i>
              </div>
              <div class="ms-3">
                <h3 class="fw-bold text-white mb-1" th:text="${rutinasCompletadas}">12</h3>
                <p class="text-muted mb-0 small fw-medium">Rutinas Completadas</p>
                <small class="text-muted">de <span th:text="${rutinasTotal}">15</span> asignadas</small>
              </div>
            </div>
          </div>
        </div>

        <!-- D√≠as Activos -->
        <div class="col-lg-3 col-md-6 mb-4">
          <div class="flowfit-card stat-card-usuario">
            <div class="d-flex align-items-center">
              <div class="flowfit-icon icon-usuario">
                <i class="bi bi-calendar-week fs-2"></i>
              </div>
              <div class="ms-3">
                <h3 class="fw-bold text-white mb-1" th:text="${diasActivosEsteMes}">18</h3>
                <p class="text-muted mb-0 small fw-medium">D√≠as Activos</p>
                <small class="text-muted">este mes</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Racha Actual -->
        <div class="col-lg-3 col-md-6 mb-4">
          <div class="flowfit-card stat-card-usuario">
            <div class="d-flex align-items-center">
              <div class="flowfit-icon icon-usuario">
                <i class="bi bi-fire fs-2"></i>
              </div>
              <div class="ms-3">
                <h3 class="fw-bold text-white mb-1" th:text="${rachaActual}">7</h3>
                <p class="text-muted mb-0 small fw-medium">Racha Actual</p>
                <small class="text-muted">d√≠as consecutivos</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Gr√°ficos de Progreso -->
      <div class="row mb-4">
        <!-- Progreso Semanal -->
        <div class="col-lg-8 mb-4">
          <div class="flowfit-card card-usuario">
            <div class="card-header d-flex justify-content-between align-items-center">
              <div>
                <h5 class="mb-1 fw-bold text-white">
                  <i class="bi bi-graph-up me-2 icon-usuario"></i>Progreso Semanal
                </h5>
                <p class="text-muted mb-0 small">Tu evoluci√≥n en los √∫ltimos 7 d√≠as</p>
              </div>
              <div class="dropdown">
                <button class="btn btn-outline-light btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                  <i class="bi bi-three-dots"></i>
                </button>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="#" onclick="cambiarPeriodoGrafico('7')">√öltimos 7 d√≠as</a></li>
                  <li><a class="dropdown-item" href="#" onclick="cambiarPeriodoGrafico('30')">√öltimo mes</a></li>
                  <li><a class="dropdown-item" href="#" onclick="cambiarPeriodoGrafico('90')">√öltimos 3 meses</a></li>
                </ul>
              </div>
            </div>
            <div class="chart-container">
              <canvas id="progresoChart" height="300"></canvas>
            </div>
          </div>
        </div>

        <!-- Distribuci√≥n de Rutinas -->
        <div class="col-lg-4 mb-4">
          <div class="flowfit-card card-usuario">
            <div class="card-header">
              <h5 class="mb-1 fw-bold text-white">
                <i class="bi bi-pie-chart me-2 icon-usuario"></i>Estado de Rutinas
              </h5>
              <p class="text-muted mb-0 small">Distribuci√≥n actual</p>
            </div>
            <div class="chart-container">
              <canvas id="distribucionChart" height="250"></canvas>
            </div>
            <div class="chart-legend mt-3">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="d-flex align-items-center">
                  <div class="legend-dot bg-success me-2"></div>
                  <span class="small text-muted">Completadas</span>
                </div>
                <span class="small fw-medium text-white" th:text="${rutinasCompletadas}">12</span>
              </div>
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="d-flex align-items-center">
                  <div class="legend-dot bg-primary me-2"></div>
                  <span class="small text-muted">En Progreso</span>
                </div>
                <span class="small fw-medium text-white" th:text="${rutinasEnProgreso}">3</span>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                  <div class="legend-dot bg-secondary me-2"></div>
                  <span class="small text-muted">Pausadas</span>
                </div>
                <span class="small fw-medium text-white">0</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Rutinas Recientes y Motivaci√≥n -->
      <div class="row mb-4">
        <!-- Rutinas Recientes -->
        <div class="col-lg-8 mb-4">
          <div class="flowfit-card card-usuario">
            <div class="card-header d-flex justify-content-between align-items-center">
              <div>
                <h5 class="mb-1 fw-bold text-white">
                  <i class="bi bi-clock-history me-2 text-warning"></i>Actividad Reciente
                </h5>
                <p class="text-muted mb-0 small">Tus √∫ltimas rutinas trabajadas</p>
              </div>
              <a th:href="@{/usuario/rutinas}" class="btn btn-usuario-outline btn-sm">
                <i class="bi bi-eye me-1"></i>Ver Todas
              </a>
            </div>
            <div class="rutinas-recientes">
              <div th:each="rutina : ${rutinasAsignadas}" th:if="${rutinaStat.index < 5}" 
                   class="rutina-reciente-item">
                <div class="d-flex align-items-center">
                  <div class="rutina-status" th:classappend="${rutina.estado.toString() == 'COMPLETADA'} ? 'completed' : 'active'">
                    <i th:class="${rutina.estado.toString() == 'COMPLETADA'} ? 'bi bi-check-circle-fill' : 'bi bi-play-circle-fill'"></i>
                  </div>
                  <div class="flex-grow-1 ms-3">
                    <h6 class="mb-1 text-white" th:text="'Rutina ID: ' + ${rutina.rutinaId}">Rutina de Fuerza</h6>
                    <div class="d-flex align-items-center">
                      <small class="text-muted me-3" th:text="'Asignada: ' + ${#temporals.format(rutina.fechaAsignacion, 'dd/MM/yyyy')}">Asignada: 15/03/2024</small>
                      <div class="progress flex-grow-1 me-3" style="height: 6px;">
                        <div class="progress-bar bg-success" th:style="'width: ' + ${rutina.progreso} + '%'"></div>
                      </div>
                      <small class="text-muted" th:text="${rutina.progreso} + '%'">85%</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Panel de Motivaci√≥n -->
        <div class="col-lg-4 mb-4">
          <div class="flowfit-card card-usuario">
            <div class="text-center">
              <div class="motivation-icon">
                <i class="bi bi-award-fill text-warning fs-1"></i>
              </div>
              <h5 class="text-white fw-bold mb-2">¬°Excelente Progreso!</h5>
              <p class="text-muted mb-3">Has completado <span class="fw-bold" style="color: var(--usuario-primary);" th:text="${rutinasCompletadas}">12</span> rutinas este mes.</p>
              
              <!-- Pr√≥ximos Objetivos -->
              <div class="objetivos-section">
                <h6 class="text-white mb-3">
                  <i class="bi bi-target me-2"></i>Pr√≥ximos Objetivos
                </h6>
                <div class="objetivo-item mb-2">
                  <div class="d-flex justify-content-between align-items-center">
                    <span class="small text-muted">Completar 15 rutinas</span>
                    <span class="badge bg-primary" th:text="${rutinasCompletadas} + '/15'">12/15</span>
                  </div>
                  <div class="progress-usuario mt-1">
                    <div class="progress-bar" th:style="'width: ' + ${(rutinasCompletadas * 100) / 15} + '%'"></div>
                  </div>
                </div>
                <div class="objetivo-item mb-2">
                  <div class="d-flex justify-content-between align-items-center">
                    <span class="small text-muted">Racha de 10 d√≠as</span>
                    <span class="badge bg-warning" th:text="${rachaActual} + '/10'">7/10</span>
                  </div>
                  <div class="progress-usuario mt-1">
                    <div class="progress-bar" th:style="'width: ' + ${(rachaActual * 100) / 10} + '%'"></div>
                  </div>
                </div>
                <div class="objetivo-item">
                  <div class="d-flex justify-content-between align-items-center">
                    <span class="small text-muted">20 d√≠as activos</span>
                    <span class="badge bg-success" th:text="${diasActivosEsteMes} + '/20'">18/20</span>
                  </div>
                  <div class="progress-usuario mt-1">
                    <div class="progress-bar" th:style="'width: ' + ${(diasActivosEsteMes * 100) / 20} + '%'"></div>
                  </div>
                </div>
              </div>

              <!-- Mensaje Motivacional -->
              <div class="motivation-message mt-4 p-3 rounded-3" style="background: var(--flowfit-glass-bg); border: 1px solid var(--flowfit-glass-border);">
                <i class="bi bi-emoji-smile mb-2 fs-4" style="color: var(--usuario-primary);"></i>
                <p class="small text-white mb-0">
                  <span th:if="${progresoGeneral >= 80}">¬°Est√°s en una racha incre√≠ble! Sigue as√≠ y alcanzar√°s tus metas.</span>
                  <span th:if="${progresoGeneral >= 60 && progresoGeneral < 80}">¬°Muy buen trabajo! Est√°s por encima del promedio.</span>
                  <span th:if="${progresoGeneral >= 40 && progresoGeneral < 60}">Buen progreso. Mant√©n la consistencia para mejores resultados.</span>
                  <span th:if="${progresoGeneral < 40}">¬°Cada paso cuenta! Mant√©n el ritmo y ver√°s mejoras pronto.</span>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div> <!-- Cierre container-fluid -->
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Sidebar Toggle
    document.getElementById('sidebarToggle').addEventListener('click', function() {
      document.getElementById('sidebar').classList.toggle('collapsed');
      document.getElementById('main-content').classList.toggle('expanded');
    });

    // Datos reales desde Thymeleaf
    const progresoGeneralData = /*[[${progresoGeneral}]]*/ 0;
    const rutinasCompletadasData = /*[[${rutinasCompletadas}]]*/ 0;
    const rutinasEnProgresoData = /*[[${rutinasEnProgreso}]]*/ 0;
    const diasActivosData = /*[[${diasActivosEsteMes}]]*/ 0;
    const rachaActualData = /*[[${rachaActual}]]*/ 0;
    const progresoSemanalData = /*[[${progresoSemanal}]]*/ [];

    // Gr√°fico de Progreso Semanal
    const ctx = document.getElementById('progresoChart').getContext('2d');
    
    // Generar datos de progreso basados en datos reales o simulados
    const generateWeeklyData = () => {
      if (progresoSemanalData && progresoSemanalData.length > 0) {
        // Usar datos reales si est√°n disponibles
        return progresoSemanalData.map(item => item[1] || 0);
      } else {
        // Generar datos simulados basados en el progreso real del usuario
        const baseProgress = progresoGeneralData;
        const variation = 10; // Variaci√≥n m√°xima
        return Array.from({length: 7}, (_, i) => {
          const randomVariation = (Math.random() - 0.5) * variation;
          return Math.max(0, Math.min(100, baseProgress + randomVariation));
        });
      }
    };

    // Generar etiquetas para el gr√°fico
    const generateWeeklyLabels = () => {
      if (progresoSemanalData && progresoSemanalData.length > 0) {
        return progresoSemanalData.map(item => {
          const fecha = new Date(item[0]);
          return fecha.toLocaleDateString('es-ES', { weekday: 'short' });
        });
      } else {
        return ['Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b', 'Dom'];
      }
    };

    const progresoChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: generateWeeklyLabels(),
        datasets: [{
          label: 'Progreso %',
          data: generateWeeklyData(),
          borderColor: '#28a745',
          backgroundColor: 'rgba(40, 167, 69, 0.1)',
          borderWidth: 3,
          fill: true,
          tension: 0.4,
          pointBackgroundColor: '#28a745',
          pointBorderColor: '#fff',
          pointBorderWidth: 2,
          pointRadius: 6
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            max: 100,
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            },
            ticks: {
              color: 'rgba(255, 255, 255, 0.7)',
              callback: function(value) {
                return value + '%';
              }
            }
          },
          x: {
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            },
            ticks: {
              color: 'rgba(255, 255, 255, 0.7)'
            }
          }
        },
        interaction: {
          intersect: false,
          mode: 'index'
        },
        elements: {
          point: {
            hoverRadius: 8
          }
        }
      }
    });

    // Gr√°fico de Distribuci√≥n
    const ctx2 = document.getElementById('distribucionChart').getContext('2d');
    const distribucionChart = new Chart(ctx2, {
      type: 'doughnut',
      data: {
        labels: ['Completadas', 'En Progreso', 'Pausadas'],
        datasets: [{
          data: [rutinasCompletadasData, rutinasEnProgresoData, 0],
          backgroundColor: ['#28a745', '#007bff', '#6c757d'],
          borderWidth: 0,
          cutout: '70%'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          }
        }
      }
    });

    // Funci√≥n para cambiar per√≠odo del gr√°fico
    function cambiarPeriodoGrafico(dias) {
      // Aqu√≠ se puede implementar l√≥gica para cambiar los datos del gr√°fico
      console.log('Cambiando a per√≠odo de ' + dias + ' d√≠as');
      // Por ahora solo mostramos un mensaje
      const toast = new bootstrap.Toast(document.createElement('div'));
      // Implementar cambio de datos si es necesario
    }

    // Animaciones de entrada
    window.addEventListener('load', function() {
      // Animar las tarjetas de estad√≠sticas
      const statCards = document.querySelectorAll('.stat-card');
      statCards.forEach((card, index) => {
        setTimeout(() => {
          card.style.opacity = '0';
          card.style.transform = 'translateY(20px)';
          card.style.transition = 'all 0.5s ease';
          
          setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
          }, 100);
        }, index * 100);
      });

      // Animar n√∫meros con efecto contador
      const statNumbers = document.querySelectorAll('.stat-number');
      statNumbers.forEach(number => {
        const finalValue = parseInt(number.textContent.replace(/[^\d]/g, ''));
        if (!isNaN(finalValue)) {
          animateNumber(number, 0, finalValue, 1500);
        }
      });
    });

    // Funci√≥n para animar n√∫meros
    function animateNumber(element, start, end, duration) {
      let startTime = null;
      const originalText = element.textContent;
      const suffix = originalText.replace(/[\d]/g, '');
      
      function animate(currentTime) {
        if (startTime === null) startTime = currentTime;
        const progress = Math.min((currentTime - startTime) / duration, 1);
        const current = Math.round(progress * (end - start) + start);
        element.textContent = current + suffix;
        
        if (progress < 1) {
          requestAnimationFrame(animate);
        }
      }
      
      requestAnimationFrame(animate);
    }
  </script>

  <!-- Sidebar Responsive JS -->
  <!-- FlowFit VIP Usuario Script -->
  <script>
    // Mobile Sidebar Toggle
    document.addEventListener('DOMContentLoaded', function() {
      const sidebarToggle = document.getElementById('sidebarToggle');
      const sidebar = document.getElementById('sidebar');
      const sidebarOverlay = document.getElementById('sidebarOverlay');

      function toggleSidebar() {
        sidebar.classList.toggle('show');
        sidebarOverlay.classList.toggle('show');
      }

      function closeSidebar() {
        sidebar.classList.remove('show');
        sidebarOverlay.classList.remove('show');
      }

      sidebarToggle?.addEventListener('click', toggleSidebar);
      sidebarOverlay?.addEventListener('click', closeSidebar);

      // Close sidebar on escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeSidebar();
      });

      // Highlight active navigation
      const currentPath = window.location.pathname;
      const navLinks = document.querySelectorAll('.nav-link-usuario');
      
      navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === currentPath) {
          link.classList.add('active');
        }
      });

      console.log('FlowFit VIP Usuario Progreso loaded successfully! üí™');
    });
  </script>

</body>
</html>